## 2.1.2  단일 블록에 대한 S-매트릭스 및 결합 계수(coupling coefficient) 연산자 계산

앞서 단일 블록 내부에 존재하는 블로흐 고유모드(1D 구조의 경우 평면파 4개)를 전반적으로 분석했습니다. 이제 외부에서 입사하는 평면파에 대한 반사·투과장을 구해야 합니다. 이에 대해서는 본서에서 표준 해석 도구로 사용하는 **S-매트릭스 방법**을 이용합니다. 그림 2.1에서 보는 것처럼, 단일 블록의 S-매트릭스 해석은 해당 블록에 대한 양방향(bidirectional) 산란 특성을 파악하는 과정을 의미합니다.

**왼쪽에서 오른쪽 방향**(양의 z 방향)으로 진행하는 파동이 \(z = z_{-}\)면에서 블록으로 입사할 때, 반사·투과 전기장은 각각 \(\sigma\mathbf{E}_{r}\), \(\rho\mathbf{E}_{t}\)로 나타내고, 이때 블록 내부에서는 고유모드가 특정 결합 계수( \(C_{a,g}^{+}\) , \(C_{a,g}^{-}\) )로 중첩(superposition)되어 전자기 에너지를 \(z = z_{-}\)에서 \(z = z_{+}\) 방향으로 전달합니다. 여기서 “\(+\)”와 “\(-\)”는 앞서 분류한 블로흐 고유모드의 양(+)·음(−) 진행 방향을 나타냅니다. 그림 2.2(a)는 이때의 장(場) 구성 요소들을 개략적으로 보여줍니다.

**오른쪽에서 왼쪽 방향**(음의 z 방향)으로 진행하는 파동이 \(z = z_{+}\)면에서 블록으로 입사하는 경우를 그림 2.2(b)에 나타냈습니다. 이때 외부 입사장은 \(\sigma\mathbf{E}_{i}\), 반사장·투과장은 각각 \(\rho\mathbf{E}_{r}\), \(\sigma\mathbf{E}_{t}\)로 두며, 블록 내부 결합 계수는 \(C_{b,g}^{+}\), \(C_{b,g}^{-}\)가 됩니다.

이처럼, 양방향 각각에 대해 얻은 반사·투과 계수 및 내부 블로흐 모드 결합 계수를 전부 알면, 해당 블록의 산란 특성을 완전히 파악할 수 있습니다. 다음은 이를 수학적으로 체계화하는 과정을 살펴봅니다.

---

### 내부 전자기장의 결합 계수 표현

블록 내부 전자기장은 각 블로흐 고유모드(양·음 2개씩, 총 4개)를 중첩해 표현합니다(1D 구조 기준). 이를 식으로 쓰면 다음과 같습니다.

\[
\begin{pmatrix}
\mathbf{E} \\
\mathbf{H}
\end{pmatrix}
=
\sum_{g=1}^{M^+} C_{a,g}^{+} 
\begin{pmatrix}
\mathbf{E}^{(g)+} \\
\mathbf{H}^{(g)+}
\end{pmatrix}
+
\sum_{g=1}^{M^-} C_{a,g}^{-} 
\begin{pmatrix}
\mathbf{E}^{(g)-} \\
\mathbf{H}^{(g)-}
\end{pmatrix}.
\tag{2.19a}
\]

여기서 \(M^+\), \(M^-\)는 각각 양(+) 진행, 음(−) 진행 블로흐 모드의 개수(1D 구조에서는 각각 2개)를 뜻합니다. 

식 (2.19b), (2.19c)는 각각 양·음 진행 블로흐 모드의 전기장·자기장을 평면파 \(\exp[j(k_x x + k_y y + k_z z)]\) 형태로 정의하지만, 내부에서의 위상 기준을 다소 수정하여 \(\exp[j(k_x x + k_y y + k_z(z - z_{+})]\) 또는 \(\exp[j(k_x x + k_y y + k_z(z - z_{-})]\)처럼 쓰도록 조정합니다. 이는 수치 안정성을 높이기 위한 처리입니다.

---

### 왼쪽-오른쪽 방향( \(z = z_{-}\) 에서 입사) 해석

그림 2.2(a)처럼, 왼쪽-오른쪽 방향으로 광파가 입사한다고 가정합시다. 입사장, 반사장, 투과장은 각각 다음과 같이 평면파 형태로 나타냅니다.

\[
\mathbf{E}_{i}(\mathbf{r}) = 
\begin{pmatrix}
E_{i,x}, E_{i,y}, E_{i,z}
\end{pmatrix}
e^{j(k_x x + k_y y + k_z(z - z_-))}, 
\quad
\mathbf{E}_{r}(\mathbf{r}) =
\begin{pmatrix}
E_{r,x}, E_{r,y}, E_{r,z}
\end{pmatrix}
e^{j(k_x x + k_y y - k_z(z - z_-))},
\]
\[
\mathbf{E}_{t}(\mathbf{r}) = 
\begin{pmatrix}
E_{t,x}, E_{t,y}, E_{t,z}
\end{pmatrix}
e^{j(k_x x + k_y y + k_z(z - z_+))}.
\tag{2.20}
\]

전반사·전투과를 고려할 때, 자유공간 내에서 \(\mathbf{k} \cdot \mathbf{E} = 0\) 같은 조건(식 (2.22))에 의해 \(E_z\) 항을 제거하거나 나머지 성분으로 대체할 수 있습니다. 또한, 경계면(\(z = z_{-}, z = z_{+}\))에서의 연속 조건에 따라, 접선 방향( \(\mathbf{E}_\parallel\), \(\mathbf{H}_\parallel\)) 성분들이 연속이어야 합니다. 이 연속 조건을 식 (2.23a), (2.23b)로 나타낼 수 있습니다.

이를 좀 더 간단히 쓰면, 다음과 같은 연산자 형태의 행렬 방정식으로 정리할 수 있습니다(식 (2.24)).

\[
\begin{pmatrix}
W_h & W_h \\
V_h & V_h
\end{pmatrix}
\begin{pmatrix}
\mathbf{E}_i \\
\mathbf{E}_r
\end{pmatrix}
=
\begin{pmatrix}
W^+(z_-) & W^-(z_-) \\
V^+(z_-) & V^-(z_-)
\end{pmatrix}
\begin{pmatrix}
C_{a}^+ \\
C_{a}^-
\end{pmatrix},
\tag{2.24a}
\]
\[
\begin{pmatrix}
W^+(z_+) & W^-(z_+) \\
V^+(z_+) & V^-(z_+)
\end{pmatrix}
\begin{pmatrix}
C_{a}^+ \\
C_{a}^-
\end{pmatrix}
=
\begin{pmatrix}
W_h & W_h \\
V_h & V_h
\end{pmatrix}
\begin{pmatrix}
\mathbf{E}_t \\
\mathbf{0}
\end{pmatrix}.
\tag{2.24b}
\]

여기서 \(W_h\), \(V_h\)는 자유공간(반무한 영역)에서의 접선방향장과 관련된 행렬, \(W^{\pm}\), \(V^{\pm}\)는 블록 내부 블로흐 모드(양·음)에 대한 경계면 \(z=z_{\pm}\)에서의 장 분포를 나타내는 행렬입니다(식 (2.24c)~(2.24h) 참고). 

이 연립 방정식을 풀면, 특정 \(\mathbf{E}_i\)가 주어졌을 때, 반사·투과장(\(\mathbf{E}_r, \mathbf{E}_t\))과 내부 결합 계수 \((C_{a}^+, C_{a}^-)\)를 구할 수 있습니다. 

하지만 S-매트릭스 관점에서는 “하나의 특정 입사장”을 다루기보다, “기저(orthonormal basis)가 되는 단위 입력”에 대한 반사·투과 반응을 전부 구해둔 뒤, 이를 선형 결합으로 표현하는 방식을 취합니다(식 (2.26)). 이렇게 하면 **행렬 연산자**로 반사·투과 특성을 일괄 표현할 수 있어, 보다 일반적이고 편리합니다.

구체적으로, “\(\mathbf{E}_i\) = \bigl(1,0\bigr)\)인 단위 편광 입력”과 “\(\mathbf{E}_i\) = \bigl(0,1\bigr)\)인 또 다른 단위 편광 입력”에 대해서 각각 해를 구해, 이 둘을 열 벡터로 묶으면 반사 계수 행렬 \(\sigma R\)와 투과 계수 행렬 \(\rho T\)를 얻을 수 있습니다(식 (2.25)). 또한 내부 고유모드 결합 계수도 마찬가지로 행렬 연산자를 사용해 표현할 수 있습니다(식 (2.27)).

이처럼, 왼쪽-오른쪽 방향에 대한 산란 연산자는

\[
\begin{pmatrix}
\sigma R & \rho T
\end{pmatrix}
,\quad
C_{a}^+,\quad
C_{a}^-
\]

등으로 정리할 수 있으며, 이를 통해 단일 블록이 임의 편광·임의 세기의 광파에 대해 어떤 반사·투과 응답을 갖는지 포괄적으로 표현할 수 있습니다(그림 2.3(a) 참조).

---

### 오른쪽-왼쪽 방향( \(z = z_{+}\) 에서 입사) 해석

오른쪽에서 왼쪽 방향의 경우(그림 2.2(b))에도 동일한 원리에 따라 수식을 전개합니다. 다만, \(\mathbf{E}_i\), \(\mathbf{E}_r\), \(\mathbf{E}_t\)의 위상因수가 \(\exp[j(k_z(z - z_{+}))]\) 등으로 바뀌고, 접선방향 경계 조건 식 (2.31a), (2.31b)에 의해 다시 한 번 연립 방정식을 세울 수 있습니다(식 (2.32)).

이를 통해 “오른쪽-왼쪽” 단위 입력 2개(편광 기저)에 대한 반사·투과, 내부 결합 계수( \(C_{b,g}^{+}, C_{b,g}^{-}\) )를 전부 구하면, \(\rho R\), \(\sigma T\)라는 또 다른 행렬 연산자를 얻습니다(식 (2.33)). 

마찬가지로 내부 결합 계수 행렬 \(\displaystyle C_{b}\)를 정의할 수 있으며(식 (2.33d)), 궁극적으로는 단일 블록의 양방향 산란 특성을 하나의 S-매트릭스로 묶어 표현하는 방식도 가능합니다:

\[
S =
\begin{pmatrix}
\mathbf{T} & \mathbf{R} \\
\mathbf{R} & \mathbf{T}
\end{pmatrix}.
\tag{2.33e}
\]

여기서 \(\mathbf{R}\), \(\mathbf{T}\)는 (편광 기저에 대한) 반사·투과 계수 행렬이며, 실제 해석에서는 \(\sigma R, \rho R, \sigma T, \rho T\) 등으로 구분해 사용할 수 있습니다. 이러한 S-매트릭스를 이용하면, 단일 블록을 “블랙박스”처럼 취급하여, 이후 다중 블록 구조로 확장할 때 용이하게 블록 간 상호 연결을 구현할 수 있습니다.
